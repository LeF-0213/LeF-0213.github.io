---
layout: post
related_posts:
  - /aiLog/da
title:  "Numpy(ë„˜íŒŒì´)"
date:   2025-12-03
categories:
  - da
description: >
  
---
* toc
{:toc .large-only}

#  ë„˜íŒŒì´(Numpy)

ë„˜íŒŒì´(Numpy)ëŠ” íŒŒì´ì¬ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê³¼í•™ ë° ìˆ˜í•™ ì—°ì‚°ì„ ìœ„í•œ ê°•ë ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤. 
ì£¼ë¡œ ë‹¤ì°¨ì› ë°°ì—´ì„ ë‹¤ë£¨ëŠ”ë° íŠ¹í™”ë˜ì–´ ìˆì–´, ë°ì´í„° ë¶„ì„, ë¨¸ì‹ ëŸ¬ë‹, ê³¼í•™ ê³„ì‚° ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ë„ë¦¬ ì‚¬ìš©ëœë‹¤. 
ë„˜íŒŒì´ ë°°ì—´ì€ C ì–¸ì–´ë¡œ êµ¬í˜„ë˜ì–´ ìˆì–´ ì—°ì‚°ì´ ë¹ ë¥´ê³  íš¨ìœ¨ì ì´ë‹¤.
íŠ¹íˆ í° ë°ì´í„°ì…‹ì—ì„œ ìˆ˜ì¹˜ ì—°ì‚°ì„ ìˆ˜í–‰í•  ë•Œ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë³´ì¸ë‹¤.
ë˜í•œ ë©”ëª¨ë¦¬ ì‚¬ìš©ì„ ìµœì í™”í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.

```bash
# ì„¤ì¹˜
pip install numpy
```

```python
import numpy as np
```

## Numpyì˜ ì£¼ìš” íŠ¹ì§•ê³¼ ê¸°ëŠ¥

### ë‹¤ì°¨ì› ë°°ì—´(N-dimensional array)

Numpyì˜ í•µì‹¬ì€ ë‹¤ì°¨ì› ë°°ì—´ì¸ `ndarray`ì´ë‹¤. `ndarray`ëŠ” ë™ì¼í•œ ìë£Œí˜•ì„ ê°€ì§€ëŠ” ì›ì†Œë“¤ë¡œ ì´ë£¨ì–´ì ¸ìˆë‹¤. ë‹¤ì°¨ì› ë°°ì—´ì€ 1ì°¨ì›, 2ì°¨ì›, 3ì°¨ì› ë“± ë‹¤ì–‘í•œ ì°¨ì›ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

```python
ndarr1 = np.array([1, 2, 3, 4])
print(ndarr1)
print(type(ndarr1))
print(type(ndarr1[0]))

"""
[1, 2, 3, 4]
<class 'numpy.ndarray'>
<class 'numpy.int64'>
"""

ndarr2 = np.array([[1, 2, 3], [4, 5, 6]])
print(ndarr2)
print(type(ndarr2))
print(type(ndarr2[0]))

"""
[[1, 2, 3]
 [4, 5, 6]]
<class 'numpy.ndarray'>
<class 'numpy.ndarray'
"""
```

### ë¦¬ìŠ¤íŠ¸ì™€ ndarray ë³€í™˜

ë°ì´í„° íƒ€ì…ì„ ë‹¤ë¥¸ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ ìˆë‹¤. ë¦¬ìŠ¤íŠ¸ì—ì„œ ë°°ì—´ë¡œì˜ ë³€í™˜ì€ `np.array()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³ , ë°°ì—´ì—ì„œ ë¦¬ìŠ¤íŠ¸ë¡œì˜ ë³€í™˜ì€ `tolist()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.

```python
li = [1, 2, 3, 4]
ndarr = np.array(li)
print(type(ndarr))

"""
<class 'numpy.ndarray'>
"""

li2 = ndarr.tolist()
print(type(li2))

"""
<class 'list'>
"""
```

### ndarrayì˜ ë°ì´í„° íƒ€ì…

Numpyì˜ ndarrayëŠ” **ë™ì¼í•œ ìë£Œí˜•**ì„ ê°€ì§€ëŠ” ì›ì†Œë“¤ë¡œ ì´ë£¨ì–´ì ¸ ìˆìœ¼ë©°, ë‹¤ì–‘í•œ ë°ì´í„° íƒ€ì…ì„ ì§€ì›í•œë‹¤.

**list**

```python
li = [1, 3.14, 'Python', 'ğŸ˜Š', True]
print(li)
print(type(li))
print(type(li[0]))
print(type(li[1]))
print(type(li[2]))
print(type(li[3]))
print(type(li[4]))

"""
[1, 3.14, 'Python', 'ğŸ˜Š', True]
<class 'list'>
<class 'int'>
<class 'float'>
<class 'str'>
<class 'str'>
<class 'bool'>
"""
```

**ndarray**

```python
ndarr1 = np.array([1, 2, 3, 4])
print(ndarr1)
print(type(ndarr1))
print(type(ndarr1[0]))
print(type(ndarr1[1]))
print(type(ndarr1[2]))
print(type(ndarr1[3]))

"""
[1 2 3 4]
<class 'numpy.ndarray'>
<class 'numpy.int64'>
<class 'numpy.int64'>
<class 'numpy.int64'>
<class 'numpy.int64'>
"""

ndarr2 = np.array([1, 2, 3.14, 4])
print(ndarr2)
print(type(ndarr2))
print(type(ndarr2[0]))
print(type(ndarr2[1]))
print(type(ndarr2[2]))
print(type(ndarr2[3]))

"""
[1.   2.   3.14 4.  ]
<class 'numpy.ndarray'>
<class 'numpy.float64'>
<class 'numpy.float64'>
<class 'numpy.float64'>
<class 'numpy.float64'>
"""

ndarr3 = np.array([1, 2, 3.14, True])
print(ndarr3)
print(type(ndarr3))
print(type(ndarr3[0]))
print(type(ndarr3[1]))
print(type(ndarr3[2]))
print(type(ndarr3[3]))

"""
[1.   2.   3.14 1.  ]
<class 'numpy.ndarray'>
<class 'numpy.float64'>
<class 'numpy.float64'>
<class 'numpy.float64'>
<class 'numpy.float64'>
"""

ndarr4 = np.array(['1', 2, 3.14, True])
print(ndarr4)
print(type(ndarr4))
print(type(ndarr4[0]))
print(type(ndarr4[1]))
print(type(ndarr4[2]))
print(type(ndarr4[3]))

"""
['1' '2' '3.14' 'True']
<class 'numpy.ndarray'>
<class 'numpy.str_'>
<class 'numpy.str_'>
<class 'numpy.str_'>
<class 'numpy.str_'>
"""
```

> **dtype(Data Type)**
> * **í˜•ì‹ ê°•ì œ(Enforcement)**: `dtype`ì„ ì§€ì •í•˜ë©´, ë°°ì—´ì— í•´ë‹¹ í˜•ì‹ì˜ ë°ì´í„°ë§Œ ì €ì¥ë˜ë„ë¡ ê°•ì œí•œë‹¤. ë‹¤ë¥¸ í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ë„£ìœ¼ë©´ ìë™ìœ¼ë¡œ ìºìŠ¤íŒ…(í˜• ë³€í™˜)ë˜ê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

### ndarray ì¸ë±ì‹±ê³¼ ìŠ¬ë¼ì´ì‹±

Numpyì˜ ndarrayëŠ” ë¦¬ìŠ¤íŠ¸ì™€ ìœ ì‚¬í•˜ê²Œ ì¸ë±ì‹±ê³¼ ìŠ¬ë¼ì´ì‹±ì„ ì§€ì›í•œë‹¤.

**1ì°¨ì› ë°°ì—´**

```python
ndarr = np.array(['ğŸ“', 'ğŸ‰', 'ğŸŒ', 'ğŸ’', 'ğŸ‘'])
print(ndarr1)
print(ndarr1.shape)

"""
['ğŸ“' 'ğŸ‰' 'ğŸŒ' 'ğŸ’' 'ğŸ‘']
(5,)
"""

# ì¸ë±ì‹±
print(ndarr1[0])
print(ndarr1[4])
print(ndarr1[-1])
print(ndarr1[-2])

"""
ğŸ“
ğŸ‘
ğŸ‘
ğŸ’
"""

# ìŠ¬ë¼ì´ì‹±
print(ndarr1[0:3])
print(ndarr1[2:])
print(ndarr1[:3])

"""
['ğŸ“' 'ğŸ‰' 'ğŸŒ']
['ğŸŒ' 'ğŸ’' 'ğŸ‘']
['ğŸ“' 'ğŸ‰' 'ğŸŒ']
"""
```

**2ì°¨ì› ë°°ì—´**

```python
ndarr2d = np.array([[1, 2, 3, 4],
                    [5, 6, 7, 8],
                    [9, 10, 11, 12]])
print(ndarr2d)
print(ndarr2d.shape) # í–‰ì—´

"""
[[ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]]
(3, 4)
"""

# 0í–‰ ê°€ì ¸ì˜¤ê¸°
print(ndarr2d[0, :])
print(ndarr2d[0,])
print(ndarr2d[0])

"""
[1 2 3 4]
[1 2 3 4]
[1 2 3 4]
"""

# 0ì—´ ê°€ì ¸ì˜¤ê¸°
print(ndarr2d[:, 0])

"""
[1 5 9]
"""
```

#### â€¼ï¸ ndarray ì¸ë±ì‹± & ìŠ¬ë¼ì´ë”© Point

**1ì°¨ì›**

```python
ndarr1 = np.array([10, 15, 2, 8, 20, 90, 85, 44, 23, 32])
idx = [2, 5, 9]
print(ndarr1[idx])

"""
[ 2 90 32]
"""
```
**2ì°¨ì›**

```python
ndarr2d = np.array([[1, 2, 3, 4],
                    [5, 6, 7, 8],
                    [9, 10, 11, 12]])
ndarr2d[[0, 1], :]

```

## í–‰ë ¬ ì—°ì‚°

Numpyì—ì„œëŠ” ë‹¤ì°¨ì› ë°°ì—´ì¸ `ndarray`ë¥¼ ì‚¬ìš©í•˜ì—¬ í–‰ë ¬ ì—°ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. í–‰ë ¬ ì—°ì‚°ì€ ì„ í–‰ ëŒ€ìˆ˜ì™€ ê´€ë ¨ì´ ê¹Šì–´, ë°ì´í„° ê³¼í•™, ë¨¸ì‹ ëŸ¬ë‹, í†µê³„ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ì‚¬ìš©ëœë‹¤.

> **â€» ì„ í˜• ëŒ€ìˆ˜**  
>    
> ì„ í–‰ ëŒ€ìˆ˜ëŠ” ë²¡í„°ì™€ í–‰ë ¬ì„ ì‚¬ìš©í•´ ê³µê°„ê³¼ ë³€í™˜ì„ ë‹¤ë£¨ëŠ” ìˆ˜í•™ì˜ í•œ ë¶„ì•¼ì´ë‹¤.     
> ì‰½ê²Œ ë§í•´, ì—¬ëŸ¬ ìˆ«ìë¥¼ ì²´ê³„ì ìœ¼ë¡œ ë°°ì—´í•œ ë°±í„°(ë¦¬ìŠ¤íŠ¸ ê°™ì€ ê²ƒ)ì™€ í–‰ë ¬(ìˆ«ìê°€ ê²©ìë¡œ ë°°ì—´ëœ í‘œ)ì„ ì´ìš”í•´ ë°ì´í„°ë¥¼ í‘œí˜„í•˜ê³  ì¡°ì‘í•˜ëŠ” ë°©ë²•ì´ë‹¤.   
> ì„ í˜• ëŒ€ìˆ˜ëŠ” ì»´í“¨í„° ê·¸ë˜í”½ìŠ¤, ë¨¸ì‹ ëŸ¬ë‹, ë¬¼ë¦¬í•™, ê³µí•™ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ì‚¬ìš©ëœë‹¤.      
> ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ì§„ì—ì„œ ìƒ‰ìƒì„ ì¡°ì •í•˜ê±°ë‚˜, ë¡œë´‡ì´ ì›€ì§ì¼ ê²½ë¡œë¥¼ ê³„ì‚°í•˜ê±°ë‚˜, AIê°€ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ” ë°ë„ ì„ í˜• ëŒ€ìˆ˜ê°€ í•„ìš”í•˜ë‹¤.


### í–‰ë ¬ê³±(Matrix)
í–‰ë ¬ê³±ì€ ë‘ í–‰ë ¬ì„ ê³±í•´ì„œ ìƒˆë¡œìš´ í–‰ë ¬ì„ ë§Œë“œëŠ” ì—°ì‚°ìœ¼ë¡œ, ë°ì´í„°ì˜ ë³€í™˜ì´ë‚˜ ê³„ì‚°ì—ì„œ ë§ì´ ì‚¬ìš©ëœë‹¤.    
í–‰ë ¬ì€ ìˆ«ìë¥¼ ê²©ìë¡œ ë°°ì—´í•œ ê²ƒìœ¼ë¡œ, ë°±í„°ë‚˜ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ”ë° ìœ ìš©í•˜ë‹¤.

> **â€» í–‰ë ¬ê³±(Matrix Multiplication)ì˜ ê·œì¹™**
>   1. ì²« ë²ˆì§¸ í–‰ë ¬ì˜ ì—´(ê°€ë¡œ ìˆ«ì ê°œìˆ˜)ê³¼ ë‘ ë²ˆì§¸ í–‰ë ¬ì˜ í–‰(ì„¸ë¡œ ìˆ«ì ê°œìˆ˜)ì´ ê°™ì•„ì•¼ í•œë‹¤. (ì˜ˆ: Aê°€ 2x3 í–‰ë ¬, Bê°€ 3x2 í–‰ë ¬)
>   2. ê²°ê³¼ í–‰ë ¬ì€ ì²« ë²ˆì§¸ í–‰ë ¬ì˜ í–‰ ê°œìˆ˜ x ë‘ ë²ˆì§¸ í–‰ë ¬ì˜ ì—´ ê°œìˆ˜ì´ë‹¤. (ì˜ˆ: A(2 x 3) x B(3 x 2) -> ê²°ê³¼ëŠ” 2 x 2 í–‰ë ¬)
>   3. í–‰ë ¬ê³±ì€ ì²« ë²ˆì§¸ í–‰ë ¬ì˜ í•œ í–‰ê³¼ ë‘ ë²ˆì§¸ í–‰ë ¬ì˜ í•œ ì—´ì„ ê°ê° ê³±í•œ ë’¤ ë”í•´ì„œ ê³„ì‚°í•œë‹¤.

```python
ndarr1 = np.array([[1, 2, 3],
                   [1, 2, 3],
                   [2, 3, 4]])
ndarr2 = np.array([[1, 2],
                   [3, 4],
                   [5, 6]])
print(ndarr1.shape)  # (3, 3)
print(ndarr2.shape)  # (3, 2)

# Matrix ê·œì¹™
print((1*1 + 2*3 + 3*5), (1*2 + 2*4 + 3*6))
print((1*1 + 2*3 + 3*5), (1*2 + 2*4 + 3*6))
print((2*1 + 3*3 + 4*5), (2*2 + 3*4 + 4*6))

"""
22 28
22 28
31 40
"""
```

#### `@` ì—°ì‚°ì

**í–‰ë ¬ ê³±ì…ˆ(Matrix Multiplication)**ì„ ìˆ˜í–‰í•˜ëŠ” **ì „ìš© ì—°ì‚°ì**ì´ë‹¤.

```python
print(ndarr1 @ ndarr2)

"""
[[22 28]
 [22 28]
 [31 40]]
"""
```

#### `np.dot()` í•¨ìˆ˜

Numpy ì´ˆê¸°ë¶€í„° ì¡´ì¬í–ˆë˜ í•¨ìˆ˜ë¡œ, **í–‰ë ¬ ê³±ì…ˆ** ì™¸ì—ë„ **ë‚´ì (Inner Product)**ì™€ **ìŠ¤ì¹¼ë¼ ê³±(Scalar Product)**ì„ ìˆ˜í–‰í•˜ëŠ” **ë‹¤ëª©ì  í•¨ìˆ˜**ì´ë‹¤.

```python
np.dot(ndarr1, ndarr2)

"""
array([[22, 28],
       [22, 28],
       [31, 40]])
"""
```

## ìˆœì°¨ì ì¸ ê°’ ìƒì„±

NumPyì—ì„œ `np.arange()` í•¨ìˆ˜ëŠ” ì¼ì •í•œ ê°„ê²©ìœ¼ë¡œ ìˆ«ìë“¤ì„ ìƒì„±í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤. ì´ í•¨ìˆ˜ëŠ” Pythonì˜ ê¸°ë³¸ `range()` í•¨ìˆ˜ì™€ ìœ ì‚¬í•˜ì§€ë§Œ, Numpy ë°°ì—´ì„ ë°˜í™˜í•˜ë¯€ë¡œ ìˆ˜í•™ì ì¸ ì—°ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤.

**range() í•¨ìˆ˜**

```python
arr = range(1, 11)
print(arr) # range(1, 11)

for i in arr:
  print(i, end=' ')
# 1 2 3 4 5 6 7 8 9 10 
```

**np.arange() í•¨ìˆ˜**

```python
arr = np.arange(1, 11)
print(arr) # [ 1  2  3  4  5  6  7  8  9 10]
print(type(arr)) # <class 'numpy.ndarray'>

for i in arr:
  print(i, end=' ')
# 1 2 3 4 5 6 7 8 9 10 
```

## ì •ë ¬

NumPyì˜ `np.sort()` í•¨ìˆ˜ëŠ” ë°°ì—´ì„ ì •ë ¬í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤. ì´ í•¨ìˆ˜ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì›ë˜ ë°°ì—´ì„ ë³€ê²½í•˜ì§€ ì•Šê³  ì •ë ¬ëœ ë°°ì—´ì˜ ë³¸ì‚¬ë³¸ì„ ë°˜í™˜(out-of-place ë°©ì‹)í•œë‹¤.

> **in-place ë°©ì‹ì´ë€?**      
> ì›ë³¸ ë°ì´í„° êµ¬ì¡°ë¥¼ ì§ì ‘ ìˆ˜ì •í•˜ëŠ” ì²˜ë¦¬ ë°©ì‹

```python
ndarr = np.array([1, 10, 5, 7, 2, 4, 3, 6, 8, 9])
print(ndarr)
print(np.sort(ndarr))
print(ndarr)
print(np.sort(ndarr)[::-1]) # ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬

"""
[ 1 10  5  7  2  4  3  6  8  9]
[ 1  2  3  4  5  6  7  8  9 10]
[ 1 10  5  7  2  4  3  6  8  9]
[10  9  8  7  6  5  4  3  2  1]
"""
```

```python
ndarr = np.array([[11, 10, 12, 9],
                  [3, 1, 4, 2],
                  [5, 6, 7, 8]])
print(ndarr.shape)
# ì—´ ë‹¨ìœ„ë¡œ ì •ë ¬, ê° ì—´ì˜ ê°’ë“¤ì„ ê°œë³„ì ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ë©°, í–‰(row)ì˜ ìˆœì„œëŠ” ì¬ë°°ì—´
print(np.sort())
```

